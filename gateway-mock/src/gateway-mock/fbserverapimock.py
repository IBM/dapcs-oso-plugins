#
# Licensed Materials - Property of IBM
#
# (c) Copyright IBM Corp. 2024
#
# The source code for this program is not published or otherwise
# divested of its trade secrets, irrespective of what has been
# deposited with the U.S. Copyright Office
#

import logging
import sys
import time

logging.basicConfig(stream=sys.stdout, level=logging.DEBUG)
logger = logging.getLogger(__name__)


class FBServerAPIMock:
    def __init__(self):
        self.cachedCertificates = None
        self.waittime = 1

        logger.info("FBServerAPIMock initialized")

    def _set_test_documents(self, isv: list[str]):
        self.isv = isv

    def getAccessToken(self):
        logger.info("getAccessToken() mock")
        return {"accessToken": "my-access-token"}

    def broadcastResponse(self, responseType: str, content: dict[str, any]):
        logger.info(f"broadcastResponse() mock: {responseType=} {content=}")
        return {}

    def getBatchMessages(self):
        logger.info("getMessages()")
        time.sleep(self.waittime)
        self.waittime = 10
        return [
            {
                "msg": {
                    "type": "KEY_LINK_PROOF_OF_OWNERSHIP_REQUEST",
                    "iat": 1734029247,
                    "exp": 1734072447,
                    "payload": {
                        "payload": '{"tenantId":"bd8c5871-f8cc-5c0b-8eac-9dd8bc30899a","requestId":"a4963c1f-f2be-4e3c-9a3a-0d2627aaf9bc","version":"2.0.0","timestamp":1734029247,"type":"KEY_LINK_PROOF_OF_OWNERSHIP_REQUEST","algorithm":"ECDSA_SECP256K1","keyId":"ab79ca1a-45cc-4cbe-b48c-6b7caa1336cd","signingDeviceKeyId":"46c3933b-7d9a-41a4-9d69-696527902c5e","messagesToSign":[{"message":"de31ce2985478fe31840d682a2ca2664da9d7da2d14ab0217dd3a50813a7bf2b","index":0}]}',
                        "payloadSignatureData": {
                            "service": "CONFIGURATION_MANAGER",
                            "signature": "30992da0432e67d0d7f6d33ddde8548532b3ab7506111a30ab14cf1c702c7c570bb0227779bc1446924dfed6a30af5b098c2fc7ae9e4e3bdc757ea3af556354fb6c8b2732930babb26d3e6a4e269bdccc7b60afdb422c65beaef4234540984476ca4d3c873ab2988500b7264c00c608046314e1a32e775c08906d0eb2174eeeaec06e2d581b6f7cd0ad9c03c521224a2491a22d33776c0f2f07c0ec14da62535e52cc94b2003e88f33b6e9fe8088438f122ce57a902c4fa6b492d6526d9750f2ee415c5d399efdb0e88a8fd99ffadb836ca923c7505aef81256ee12cb99c1df72f0214a1e02fc708892d51411e4a14ebcb41d2af4cddcd41f08ceec791bd0305",
                        },
                        "recipients": ["d326e01f-730b-4e14-b961-7fe1a2458c7e"],
                    },
                    "signature": "2b67e63f7ff7d672d8a8a86b7b6ea6accb66675df3c96fbea8c4cac54931485bc2ed920180141e218ae603f077b317b701e10dbf400422da4d41981ea09ef2ee2b217fad905e5b5640c9aee9ee4635281e9ca20b7bd9716a03099652af1b323f72a37935f22369a32d0f2fde01ef4831e8515c0af261f9c53d751a7a6fdb283ba23f44fa558c0b575151ec74ed45baed85e37e6c240158c2aae5cdb447ac1553841aa1cd7019901919445d07e4f26887dfef25ea95c7b6468c06ffdf2b4e11c31d4ddc3cce259eeee8f7edabce58cb5efc7b9090290ef72d8e3a93bb236450699db222f4ec0c920afafc2280850a6cbd836b338112b24978e4fc10234d8211ae",
                },
                "msgId": 600053000001,
                "deviceId": "d326e01f-730b-4e14-b961-7fe1a2458c7e",
                "internalMessageId": "013878fd6f63b7f23ec3dfbee1f6ba39e32105d0bebbdebd7803fbd9af961903",
            }
        ]

    def getCertificates(self):
        logger.info("getCertificates()")
        # https://github.com/fireblocks/fireblocks-agent/blob/main/src/utils/messages-utils.ts#L17
        # https://github.com/auth0/node-jsonwebtoken#jwtverifytoken-secretorpublickey-options-callback
        if self.cachedCertificates is None:
            self.cachedCertificates = {
                "cm": "-----BEGIN CERTIFICATE-----\nMIIFbDCCA1SgAwIBAgIUTg3yFY4h+JmhBVyuJnw3znNwZE8wDQYJKoZIhvcNAQEL\nBQAwfzELMAkGA1UEBhMCSUwxDzANBgNVBAgMBklzcmFlbDERMA8GA1UEBwwIVGVs\nIEF2aXYxJjAkBgNVBAoMHUZpcmVibG9ja3MgUHJvZHVjdGlvbiBSb290IENBMQ8w\nDQYDVQQLDAZEZXZPcHMxEzARBgNVBAMMCnRydXN0ZWRfY2EwHhcNMjMwODE1MTg1\nODM0WhcNMjcwOTIzMTg1ODM0WjB4MQswCQYDVQQGEwJJTDEPMA0GA1UECAwGSXNy\nYWVsMScwJQYDVQQKDB5GaXJlYmxvY2tzIFByb2R1Y3Rpb24gU2VydmljZXMxDzAN\nBgNVBAsMBkRldk9wczEeMBwGA1UEAwwVY29uZmlndXJhdGlvbl9tYW5hZ2VyMIIB\nIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtcuEBiskC6n85IvPxZRnuV+o\n1X6LDMDumH4ksF8PvTl98UL/2bklwgeiItMQaPTyKKOpm8LHTUzu/E2BB6mz+LBH\nOvX8dPgVD/gQhRMpvgCdipD05FTAERNQPla3rSdjpO9RTiCyvbIlDT1FLh64V/Ih\nL5iTRBEi2KdjLF+T68v3Jt9kK2cBDdhquS6XzJvxg0+WW7yFlgYFGCmL+dZt/Z6n\nq1CyZb9K5CefVtxW4xyaV1SbTg+Qi4VTih824fBtOJYH6V0ES0eWi48eec/yztvE\nOx0ktmYYKNN94IVBv2nt5pONBXH+M3saliDePpgLqjQiRpDLA6ms6T2p4UONAQID\nAQABo4HmMIHjMAwGA1UdEwEB/wQCMAAwDgYDVR0PAQH/BAQDAgWgMB0GA1UdJQQW\nMBQGCCsGAQUFBwMBBggrBgEFBQcDAjAdBgNVHQ4EFgQUprRshU01buLbv3WpDEeY\nkdcqpU0wHwYDVR0jBBgwFoAUaj2wU+0HH28tLhgLpdEGR/BtaMYwEQYJYIZIAYb4\nQgEBBAQDAgbAMC8GCWCGSAGG+EIBDQQiFiBGaXJlYmxvY2tzIEdlbmVyYXRlZCBD\nZXJ0aWZpY2F0ZTAgBgNVHREEGTAXghVjb25maWd1cmF0aW9uLW1hbmFnZXIwDQYJ\nKoZIhvcNAQELBQADggIBAEfTWG+Lv5ZVZnM4AOrh6hLidn3OjpuVTlnrHmaTsBan\nXQ7f1b01xvf2g9mHSe3LFQBSEtryd5GGpgpaa3oP6vhRszfiF0I3oQ6fuIVyzNWN\nS6xRbE8qsOWWTHPMXOYD9cD4pn8s7g7Bn85RTo5mgDTgWBedF3rDY0hQ3OklJRo4\n+AK1RqyvPf1anusbdlbbbprRMrIhttfhfEMUU8zaq9aLDLiLiyOGU8vCU6tucw9F\nrK3/gSk2Q5L4ReamI1FFkaUC0kbExKYF1J01PuicVo0kX9LoSvD7ix/Brtp4VPsa\nqv56EgqZheDmbjOIGJYuGMeqnICJ+Rn3jr6WxhnabSUxuRdLKKSkqCbDMvY9Dz5D\n6Mmc/ZOyu5wJKkC5UD1D5/lvNpouMNTiGo7RyQm7YAcuFE2rWQLo6/UvyqQl6nIJ\n4tYJjVJBIDsjaFOMLdsXbB9d/TAfHPBjGePbZS5xvMu5bPQO1T/OlBDjFaGfzZo0\n01sHu2f/oqcjhFfUoGjv9k2kWdceJbRVje/NlfTp/vlvL5/GUpAdNrZ7ouv7R2bG\n5MLDI3bcz7EzWeENkLKA8onBils006eorX1f84PwO9AqCZ9KmAsjJBD+HCgRm2O5\nwzMFzer6EmTgd9g8IwStrFDukPTNXE9H6th1P41RRTRNH2+meO4FPy/wrsQ7u9VZ\n-----END CERTIFICATE-----\n",
                "zs": "-----BEGIN CERTIFICATE-----\nMIIFWjCCA0KgAwIBAgIUTg3yFY4h+JmhBVyuJnw3znNwZFIwDQYJKoZIhvcNAQEL\nBQAwfzELMAkGA1UEBhMCSUwxDzANBgNVBAgMBklzcmFlbDERMA8GA1UEBwwIVGVs\nIEF2aXYxJjAkBgNVBAoMHUZpcmVibG9ja3MgUHJvZHVjdGlvbiBSb290IENBMQ8w\nDQYDVQQLDAZEZXZPcHMxEzARBgNVBAMMCnRydXN0ZWRfY2EwHhcNMjMwODE1MTg1\nODM0WhcNMjcwOTIzMTg1ODM0WjBvMQswCQYDVQQGEwJJTDEPMA0GA1UECAwGSXNy\nYWVsMScwJQYDVQQKDB5GaXJlYmxvY2tzIFByb2R1Y3Rpb24gU2VydmljZXMxDzAN\nBgNVBAsMBkRldk9wczEVMBMGA1UEAwwMem9uYV9zZXJ2aWNlMIIBIjANBgkqhkiG\n9w0BAQEFAAOCAQ8AMIIBCgKCAQEA0gQn823bQ2PBb9duTI6m07QBTHcN4yPGae/N\nN6S2Sqlh+hqdZ2q8PjtmR/XKDsqMY8FiCXZR8Erng8zyldJxEw3uVEADTlWhlTwY\nl2o6WvvmxnfgoJofgK03OSHxylXyAoHChkFx2VxTXm9zPPS7L6OSpuQRtXvwGjaR\nqGcgYGo2l2oDdLOe4PZlke2ogDnu8WMbL8HrHtybBdlej7i5SzgN6b0kWCfVnXfJ\nYXBV3BKYevfXP9OpXJnk8jIN60C4k15g6ygtzFpXL9+3lzdE4mWtDkP6A8f9sk/m\nEyoonz/7IP3JdSvTJ7pcpNSk1E8ptrVl5BaxZwEimPqlL8gCnQIDAQABo4HdMIHa\nMAwGA1UdEwEB/wQCMAAwDgYDVR0PAQH/BAQDAgWgMB0GA1UdJQQWMBQGCCsGAQUF\nBwMBBggrBgEFBQcDAjAdBgNVHQ4EFgQUkMqVl3Zaq0wFm/colNwA49tylPswHwYD\nVR0jBBgwFoAUaj2wU+0HH28tLhgLpdEGR/BtaMYwEQYJYIZIAYb4QgEBBAQDAgbA\nMC8GCWCGSAGG+EIBDQQiFiBGaXJlYmxvY2tzIEdlbmVyYXRlZCBDZXJ0aWZpY2F0\nZTAXBgNVHREEEDAOggx6b25hLXNlcnZpY2UwDQYJKoZIhvcNAQELBQADggIBACSl\nTTyY/XtYFolt6lHgSnGMa99crE19V4mzBaWmCKgmamMEj/z/wcJIRC1Z41CkZB4e\nHnS3aOxIbePfTSxwWu9oLIUeh9UlQASzZwN0cWyZysELV4uaAPfS28AXGy3uGvb6\nFYizTNEY3HefGuhtQM82jDCjzqGV1KX7PTuKbuxPc4BgLzBhHB1FruXobIvQaKBh\nSykOMtQiCYmzPKmLNl6jy3PAOhNBrh8wBJlXFUHOK0O4RmeXN9Fkv/VnqBbFNdK6\naqsQL3KLopxiUujCeD72Am5lfk+nlEcsXrEjRPisy7KsQU9fWA5cs1b105pbx2KO\nlDWuCdCkvdKMJ56ZXVZ+TaPmPD2R5/b+cnHDfMBbruCac7HEzx1kYzai/CnSbxJC\nwd/q9e1hyQY5wdhvsoRmZPthU5OxM1xuoVoAfmoMsQeqm+1UBYFXcBCs+KprH1m/\nKsEHH8MhU6zCQNRzJdU7AhQyONRwQHUCSqoOfKpfUSFawtlSYbsyJESLwWoFxzQF\n6uLiUl9bDBJPQFD+Bedol2GymNIKTsXCL2v31AsapR76JSYE4dIV4YXQbd20LwB5\nQdkaffDtQlX3MJnSiLCVv+VqsTlfygIwv1jRwqOdQPSuTtmNqQY8uMd0FwdOlCwS\nKIH49+ApuUvqmZ3RpTexMwGD6PBKaAKkopd14McP\n-----END CERTIFICATE-----\n",
                "vs": "-----BEGIN CERTIFICATE-----\nMIIFXDCCA0SgAwIBAgIUTg3yFY4h+JmhBVyuJnw3znNwZFEwDQYJKoZIhvcNAQEL\nBQAwfzELMAkGA1UEBhMCSUwxDzANBgNVBAgMBklzcmFlbDERMA8GA1UEBwwIVGVs\nIEF2aXYxJjAkBgNVBAoMHUZpcmVibG9ja3MgUHJvZHVjdGlvbiBSb290IENBMQ8w\nDQYDVQQLDAZEZXZPcHMxEzARBgNVBAMMCnRydXN0ZWRfY2EwHhcNMjMwODE1MTg1\nODM0WhcNMjcwOTIzMTg1ODM0WjBwMQswCQYDVQQGEwJJTDEPMA0GA1UECAwGSXNy\nYWVsMScwJQYDVQQKDB5GaXJlYmxvY2tzIFByb2R1Y3Rpb24gU2VydmljZXMxDzAN\nBgNVBAsMBkRldk9wczEWMBQGA1UEAwwNdmF1bHRfc2VydmljZTCCASIwDQYJKoZI\nhvcNAQEBBQADggEPADCCAQoCggEBALwWXYXW75SeRL1dQZ4PEpqEz4D27fr4prx+\nyjWX9UX0yM3l1q7StnbBHCaWW+wFKc2kFE14WXZq7FQyB68Im7MK30apJ/Cj9Jgj\nJDPy9wHDEo+XJq0CHQ9afmDwiDI6wNnyuHa7awB8kf2hDfA+O65I0ExyV5ogt5V2\nyZqYDhdsR48O14lNW6oT903RR6lUyYQA3ha82hpfQToydA08p/MPKCPiIRtMkhmQ\nPznjB0nKBiV7dH3jeRiuRyqiiobwAWI0hZsVxagLjc1SeAgjhWQaHEqV0RMgCU3X\nlKcaezE6aZ2db3wVCrEbXQTWq6fucAOecTQSQgUuCiC3iRw2OK0CAwEAAaOB3jCB\n2zAMBgNVHRMBAf8EAjAAMA4GA1UdDwEB/wQEAwIFoDAdBgNVHSUEFjAUBggrBgEF\nBQcDAQYIKwYBBQUHAwIwHQYDVR0OBBYEFHfn5X5OkFcSwwjAvSHoJeFUo2NbMB8G\nA1UdIwQYMBaAFGo9sFPtBx9vLS4YC6XRBkfwbWjGMBEGCWCGSAGG+EIBAQQEAwIG\nwDAvBglghkgBhvhCAQ0EIhYgRmlyZWJsb2NrcyBHZW5lcmF0ZWQgQ2VydGlmaWNh\ndGUwGAYDVR0RBBEwD4INdmF1bHQtc2VydmljZTANBgkqhkiG9w0BAQsFAAOCAgEA\nPrhKd+UHXRfX+MBip7ggz72kgoZRvJ0HcTv1Och3gvUIjYqjk8A5T5/92+sLnUAZ\n6vSSPrqJX9qRN1UCPMrlP2+rB9TCy8M9dfLw/WJjlAJJ9cEvBX8hv+bcGMVA9uT6\nh3R8NiVriKJOngBCANEg08oTOULbyyQadNYq8S/gZUkWmth6TjW+kEM7BmPYAdiC\nqsQvNpKHXtAqOJRCmjMQ4Kp7/DMz4Gl8+qVwZezAkCqZ6PVtuKo8KX/PndZE5Ej7\nu0iY7zJcmJtKYHCgKXE84Qth1EmWj0udicTssaRGi68OzuHZI1FNP58dlDH8hiFW\njrwybNMEwoBFY2ujMVYZdCKZBE2SXU+l6d010aNzXLQhVkFLXOxu+ZX97N3xP7mZ\niODEZcwcCShzx3Oc07kKwokybnJ5NEghLk0Osz2QIfsuZNKxenEJzrsbxbNKbzLP\nfJLDrrkmK9MXsfCBV9s9vjsb6dlYPwXOHUNQeJdaswF69oA+w03Kjv5bRq+DAf8H\nn7bj3UPcmn4kXQi4M+ukJiU/YTPHNb0fSbYF4xb/gLZHBLxSvUCuaX3qirCJvn8b\n6Uncr2fm0PuC1eEHnKdYWIQLo3NRHVzNFezUvKE6/sXBONqG7Q3O5cs2W5yyb2Mb\nKlflvKEqKxjCeZ0xujgNMLou10K7QKa8AhWm32yQzhM=\n-----END CERTIFICATE-----\n",
                "ps": "-----BEGIN CERTIFICATE-----\nMIIFXjCCA0agAwIBAgIUTg3yFY4h+JmhBVyuJnw3znNwZFYwDQYJKoZIhvcNAQEL\nBQAwfzELMAkGA1UEBhMCSUwxDzANBgNVBAgMBklzcmFlbDERMA8GA1UEBwwIVGVs\nIEF2aXYxJjAkBgNVBAoMHUZpcmVibG9ja3MgUHJvZHVjdGlvbiBSb290IENBMQ8w\nDQYDVQQLDAZEZXZPcHMxEzARBgNVBAMMCnRydXN0ZWRfY2EwHhcNMjMwODE1MTg1\nODM0WhcNMjcwOTIzMTg1ODM0WjBxMQswCQYDVQQGEwJJTDEPMA0GA1UECAwGSXNy\nYWVsMScwJQYDVQQKDB5GaXJlYmxvY2tzIFByb2R1Y3Rpb24gU2VydmljZXMxDzAN\nBgNVBAsMBkRldk9wczEXMBUGA1UEAwwOcG9saWN5X3NlcnZpY2UwggEiMA0GCSqG\nSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDAmWtwPRSxYYaojTqveaBTi9QZN8NI51U0\n46j8jXLTaJ9QDRKN2WuiLHzsf0Y628n88kgJmFF5sP0zvxLe741yiixj83t2se52\nJrdKhSU04sCXuR17zkOzc4FB2TvLkdM79qQvzNBvFR6uFIZps3uAtujyVPhLBOz+\nE1UumasgxxyuMJlzv5zLPGJVA6HhIBDzn6joeYA00DujV1j4MTPcitNYWuOVoPNT\nm40+Ecp1mAgoAjHn5hbUnTZsiaILaOSttfWYA7thn4nutvh7MBq+MrYzY87hfLCA\nxm+QqohRk2lU86r8oPZpCtKg05W6NS+uTKFL9mOKBmlab7eKwLazAgMBAAGjgd8w\ngdwwDAYDVR0TAQH/BAIwADAOBgNVHQ8BAf8EBAMCBaAwHQYDVR0lBBYwFAYIKwYB\nBQUHAwEGCCsGAQUFBwMCMB0GA1UdDgQWBBRobyooq8YNwpdS+XvTcbazuRRUDTAf\nBgNVHSMEGDAWgBRqPbBT7Qcfby0uGAul0QZH8G1oxjARBglghkgBhvhCAQEEBAMC\nBsAwLwYJYIZIAYb4QgENBCIWIEZpcmVibG9ja3MgR2VuZXJhdGVkIENlcnRpZmlj\nYXRlMBkGA1UdEQQSMBCCDnBvbGljeS1zZXJ2aWNlMA0GCSqGSIb3DQEBCwUAA4IC\nAQB9DDYg0ZXoLLMg+Q+9mIDLl+pK2yY/iSui+Y9+WR7Fya8NWUkgZDZ/vRJ/TE3J\nWAhjA7PcIAkvpp70GbcTbsl5Xf37pE1jkpnFYDNQfyLJLqPUhdNMvhqzI+80BbQZ\n9I3UEjS7+GqCFxKgLBaPVCrTGqA7Da966FZlZBadC3EgsVXs/VDZbktiAq8mwF5x\nGSzXOIT+XO/CrseQE/KbNMElfJq11CB5x6RHYyWZWLxOHuC35+4vdV4oAnyjiO13\ne0rT8ZsLc8DoyyxOzJTrek8Pdo1BpQ7pmE1ywUkp4gnL5v4uV/3VtEl6x8o9JEkU\nMjorNSlGo6Olnh9OnDmYoOzSKVm4hcz6FW2MbPISlFJW4DCWMyRK9ksnnBRwk8ew\n15TuYgcLou8rIrw0J5UF+ytVdoBmyFJdpeNIDf2JZYfRybXFxOERELvHCKZ2iYEM\nb70OrIKOElso8hZS33BT/VLjw7UcLfjek4h+HSLUEBufWWtSbTCcAoLG+EyKehLZ\nTxUlOJGl+DJC646dluTWJfdkIbnh3u7lAyBuTC5xarqSkwX5MH0VgSZch2R2Tced\nEr0C0q6C7QiWp5TU0igPODecX2tYDFw6klcB/bB/o+9AgDaYe7pGwCGDFm50I0Mi\n3/YuszdA8SK2TQEDpfor9qwzU2LdX4KqnGyNYwT9FTfCDQ==\n-----END CERTIFICATE-----\n",
                "oe": "-----BEGIN CERTIFICATE-----\nMIIFWjCCA0KgAwIBAgIUTg3yFY4h+JmhBVyuJnw3znNwZFowDQYJKoZIhvcNAQEL\nBQAwfzELMAkGA1UEBhMCSUwxDzANBgNVBAgMBklzcmFlbDERMA8GA1UEBwwIVGVs\nIEF2aXYxJjAkBgNVBAoMHUZpcmVibG9ja3MgUHJvZHVjdGlvbiBSb290IENBMQ8w\nDQYDVQQLDAZEZXZPcHMxEzARBgNVBAMMCnRydXN0ZWRfY2EwHhcNMjMwODE1MTg1\nODM0WhcNMjcwOTIzMTg1ODM0WjBvMQswCQYDVQQGEwJJTDEPMA0GA1UECAwGSXNy\nYWVsMScwJQYDVQQKDB5GaXJlYmxvY2tzIFByb2R1Y3Rpb24gU2VydmljZXMxDzAN\nBgNVBAsMBkRldk9wczEVMBMGA1UEAwwMb2ZmX2V4Y2hhbmdlMIIBIjANBgkqhkiG\n9w0BAQEFAAOCAQ8AMIIBCgKCAQEA7Z4aIbuOChPGa2dbVchpTa4kgC4qaV43MDqL\nI0iQSP2f5aqjPefBPsXPdXRMCkiwsrBsfXulPl5olIJWmY5ZTVQV+kXDbOefkZTd\nRtIbyx15DpnPTtzsomjZXUtiMDV+5aPxoEPU1cjE9w9LebMp77HUU8t7W6bMPenr\nK1aImTdLpbC9BTsrYpSDVunFiiKsLRP/JbDvYLEakMFqwHc1oDA921OZYAoBYlBb\n3oTxm4WHw8rRW8ehEQopMiqorgV7U4ObvVcDkYeqEyKLkwLxexfjjWrQNRI8s9Wj\nW9S7oZaHLBbuKa0fQEFjz15CldJwwR1VDHlL9TmauKG2pXPv9wIDAQABo4HdMIHa\nMAwGA1UdEwEB/wQCMAAwDgYDVR0PAQH/BAQDAgWgMB0GA1UdJQQWMBQGCCsGAQUF\nBwMBBggrBgEFBQcDAjAdBgNVHQ4EFgQUU1f8zb9YzfG+/xYkGK09SqIs818wHwYD\nVR0jBBgwFoAUaj2wU+0HH28tLhgLpdEGR/BtaMYwEQYJYIZIAYb4QgEBBAQDAgbA\nMC8GCWCGSAGG+EIBDQQiFiBGaXJlYmxvY2tzIEdlbmVyYXRlZCBDZXJ0aWZpY2F0\nZTAXBgNVHREEEDAOggxvZmYtZXhjaGFuZ2UwDQYJKoZIhvcNAQELBQADggIBAA/y\nWyepXX0JPPX2CQUvrbJg75kbNuScEYRlDMDi6OT3SF2Kf3w69fhrJSkTrepLoa1G\ngjmuaiaPImDDcoGthRY9T3NYMnnCjACvfjydqCdIcUgz8xwyYtnTY+C47hiAKgNK\nyzhHvA881rrgQQBz9X4BJchgxar4zOe5geFGW0cJYGYyt/L0OKLsAl3PTT+Wvoke\nflsqYwVpJvZIgZQSszKceFu7rXKSV+nyprtvl+wprVrIu70PvPPN0oyigQP8u/L6\nyuiyU8QRHbR7MEaPYuIPF8kVtUV8J0bxEEaBQFmxie8gs3QhS0cswgnprFdKtF3v\nzHh7egafdQfNqzpt29xQe2ssUSvBdiQAcoVRsFrDYmDr93a5Sb5E6kMAudT6GARQ\nAeEmm6JdzE7rg11Jmzi4g7TSYtBq4Bc6UuSwHjXYj56w7QjsLZtfwO8eFy1n7xsB\nH4TAoJU5ahZf/dl8bH1VNAVomBN2dru46QcXzn+ywi3po6eXjZFjA7tabXwTxQbH\nmMefZFeKiQpANyclyQG6JdNm6IyNiArcb/YW5LuhyZjmdWpJRNoSnXEZRVK9lXxD\ntzdovmDOOn483CNQrhm9IF5BJ675bmRnSjUEMqu0UPUTUubrEjZqWJuKHdW3Phqe\nVwF9wnNpwGvjrhR/V6acU1YJQLH53CWDigqtatdn\n-----END CERTIFICATE-----\n",
                "as": "-----BEGIN CERTIFICATE-----\nMIIF5jCCA86gAwIBAgIUTg3yFY4h+JmhBVyuJnw3znNwZE4wDQYJKoZIhvcNAQEL\nBQAwfzELMAkGA1UEBhMCSUwxDzANBgNVBAgMBklzcmFlbDERMA8GA1UEBwwIVGVs\nIEF2aXYxJjAkBgNVBAoMHUZpcmVibG9ja3MgUHJvZHVjdGlvbiBSb290IENBMQ8w\nDQYDVQQLDAZEZXZPcHMxEzARBgNVBAMMCnRydXN0ZWRfY2EwHhcNMjMwODE1MTg1\nODM0WhcNMjcwOTIzMTg1ODM0WjBvMQswCQYDVQQGEwJJTDEPMA0GA1UECAwGSXNy\nYWVsMScwJQYDVQQKDB5GaXJlYmxvY2tzIFByb2R1Y3Rpb24gU2VydmljZXMxDzAN\nBgNVBAsMBkRldk9wczEVMBMGA1UEAwwMYXV0aF9zZXJ2aWNlMIIBIjANBgkqhkiG\n9w0BAQEFAAOCAQ8AMIIBCgKCAQEAyP7MDQknKeEPVmA6ZDj2QD6jv1LXP5hzny+q\n4RGvqQd9kfRjYpuIGsh5z9SMxvfplIpdt4U4Cj5Qh8C6Fpu308IpSp7JRd9Gsjon\nXLRZGhovvu8npcnq3h63YnV6kFc/aaQeJva1wbN567O258VopJuGimAMXHxFWd+I\n3SrN01lqE/4SOGuytrbJfkfreFxwQx5pQ0ZXTGKVuj1Re+YMjWcnj2F7yVfQcieU\nQHSwvux2LjgTtI/072nfdwMaBmwDTsd3eJLjO25FsqUgngcZNZXuKG9U+bLsSZYs\n3OCxhFgeVaBhYNxRBEa3VYtc63+f2IwFcOIkjVnZrn6rjEJ6fwIDAQABo4IBaDCC\nAWQwDAYDVR0TAQH/BAIwADAOBgNVHQ8BAf8EBAMCBaAwHQYDVR0lBBYwFAYIKwYB\nBQUHAwEGCCsGAQUFBwMCMB0GA1UdDgQWBBTPMaxiMu++R1v/7s2L2L7a35oVejAf\nBgNVHSMEGDAWgBRqPbBT7Qcfby0uGAul0QZH8G1oxjARBglghkgBhvhCAQEEBAMC\nBsAwLwYJYIZIAYb4QgENBCIWIEZpcmVibG9ja3MgR2VuZXJhdGVkIENlcnRpZmlj\nYXRlMIGgBgNVHREEgZgwgZWCDGF1dGgtc2VydmljZYINYXV0aC1zZXJ2aWNlMYIN\nYXV0aC1zZXJ2aWNlMoINYXV0aC1zZXJ2aWNlM4INYXV0aC1zZXJ2aWNlNIINYXV0\naC1zZXJ2aWNlNYINYXV0aC1zZXJ2aWNlNoINYXV0aC1zZXJ2aWNlN4INYXV0aC1z\nZXJ2aWNlOIINYXV0aC1zZXJ2aWNlOTANBgkqhkiG9w0BAQsFAAOCAgEAueDrV892\nMOFmbWqPrXE0Z8iS51zIBNPizCWm87Qgd4pv6dBrYMM91A9zq5M04XZpvpbthToN\nfq/3o/aLbiDOt6Agp3AfkIGAqUoWAvOtrpL+R2g1QsjQjru1tpEVeuhxkU6SNc9J\nmS9LpfajqQngBEz14Hqc1d2mfTcpnPU/euVJdvvo85JXQ6sXcdR3Ul37s/QzL9eR\n2ZNs0H9ep5/iUIE9EySbOKc5/Qb1LTodJVhHy7roHgy0tH2rB5IE1034xVMwQT9T\nl2S/HCRTY29IpLucAgfbu97URfLQktIr18ViZ/46Zrv3W0a4VA+EeFqpE8WVWzmL\n9YurgQSEh15ikg+HSAAA5awKEfLFydrURy4rTXhAf6iItN5dwu/H6+pcskJRdBVP\naupzEH/vlVShznPRXD4YfR0pl5wDUKixeCK1h8O3zGkwWFRHLKo9utgCpcq22J9a\nLPwjBbtxFNG1Znhl5qt23oUPuDKHxn86YouyaCqatFFIUChkL2rHjBX9NY7pOzCA\n57bKS9zayq+yyf+NWSYm8uHlirrIZgUQSD4Ihniao73vyPjdA97n4OIJxLxo2BBq\nwJDtdmAPltI6VMvzJPs2yhKAUg0r0ipaNFdpNrXpr5uz4u24m6YMlTwHgw9CKnvH\nGrorzwynDqz17XyOPu0ki1pURQDaKh/D+Sk=\n-----END CERTIFICATE-----\n",
                "asr": "-----BEGIN CERTIFICATE-----\nMIIFYjCCA0qgAwIBAgIUTg3yFY4h+JmhBVyuJnw3znNwZHEwDQYJKoZIhvcNAQEL\nBQAwfzELMAkGA1UEBhMCSUwxDzANBgNVBAgMBklzcmFlbDERMA8GA1UEBwwIVGVs\nIEF2aXYxJjAkBgNVBAoMHUZpcmVibG9ja3MgUHJvZHVjdGlvbiBSb290IENBMQ8w\nDQYDVQQLDAZEZXZPcHMxEzARBgNVBAMMCnRydXN0ZWRfY2EwHhcNMjMwODE1MTkw\nMjE0WhcNMjcwOTIzMTkwMjE0WjBzMQswCQYDVQQGEwJJTDEPMA0GA1UECAwGSXNy\nYWVsMScwJQYDVQQKDB5GaXJlYmxvY2tzIFByb2R1Y3Rpb24gU2VydmljZXMxDzAN\nBgNVBAsMBkRldk9wczEZMBcGA1UEAwwQYXBwcm92YWxfc2VydmljZTCCASIwDQYJ\nKoZIhvcNAQEBBQADggEPADCCAQoCggEBALXLhAYrJAup/OSLz8WUZ7lfqNV+iwzA\n7ph+JLBfD705ffFC/9m5JcIHoiLTEGj08iijqZvCx01M7vxNgQeps/iwRzr1/HT4\nFQ/4EIUTKb4AnYqQ9ORUwBETUD5Wt60nY6TvUU4gsr2yJQ09RS4euFfyIS+Yk0QR\nItinYyxfk+vL9ybfZCtnAQ3Yarkul8yb8YNPllu8hZYGBRgpi/nWbf2ep6tQsmW/\nSuQnn1bcVuMcmldUm04PkIuFU4ofNuHwbTiWB+ldBEtHlouPHnnP8s7bxDsdJLZm\nGCjTfeCFQb9p7eaTjQVx/jN7GpYg3j6YC6o0IkaQywOprOk9qeFDjQECAwEAAaOB\n4TCB3jAMBgNVHRMBAf8EAjAAMA4GA1UdDwEB/wQEAwIFoDAdBgNVHSUEFjAUBggr\nBgEFBQcDAQYIKwYBBQUHAwIwHQYDVR0OBBYEFKa0bIVNNW7i2791qQxHmJHXKqVN\nMB8GA1UdIwQYMBaAFGo9sFPtBx9vLS4YC6XRBkfwbWjGMBEGCWCGSAGG+EIBAQQE\nAwIGwDAvBglghkgBhvhCAQ0EIhYgRmlyZWJsb2NrcyBHZW5lcmF0ZWQgQ2VydGlm\naWNhdGUwGwYDVR0RBBQwEoIQYXBwcm92YWwtc2VydmljZTANBgkqhkiG9w0BAQsF\nAAOCAgEAh9qfboZ87O1ndiOI54bx2H9Fq2bxVSbSluJm/+9uRJgXUOM9YoSVjrYp\nle2cCgWjSlKAqlP8aov1ajDkvkEbfTk2/ClW4UAKnZmm6MRCHExA244j5S1YnYTv\npp4tnBbKRedWPDOofrebsJENwi81U4j86qQeYp57Ugzkrc3oh1g4RATYMLbvFOLK\np9gZK2q7aMukAze3pd4h9GNZ+PcHmb1OTxgr/JcYs1BPqGfhS7rZwdxyZMqFHniI\njcFcMI+3a01BQhVXdbPvbll3xiI6cSADYwexPnX1iXjedIjxif4lBjDYux3ygysz\nnrKPy1te7SpRMot5bWLDEGyAaBCm8mYHfibz86p5kZhyzwvcc/+v6RIWTztpED79\nFao+EmAzU1N/2Cua6TKMw8s0oa8o6h3hT5dtYx69K/yrcOE9Ew2JSw23qxZsBYdV\ni8x2E7586bv1ikcvmKxAZ0aSh8WNA2bIYEDHl/J8wjTXD6ZIKRCLBLWD9z/0vsLF\nQQVLZ1qXGDQ7jkGYI5nv6itxm3xPFTiY8KgudhgJZqECnHg52viDKBT04LLvMAgL\nPbpuVfx+T7+w5uPspTCNzIFsCZFFjkMkahOhYK58jQXLZGT4cuE2TVilEBZShTb/\nnxnqHznForEvoK3HW+k16CH+hkSl7/gbvDTR0LroiMkjZIq3BfA=\n-----END CERTIFICATE-----\n",
            }
        return self.cachedCertificates

    def ackMessage(self, content: dict[str, any]):
        logger.info(f"ackMessage() mock: {content=}")
        return {}
